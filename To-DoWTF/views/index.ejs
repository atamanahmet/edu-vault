<%- include("partials/header.ejs") %>
<div class="container" style="display: flex; flex-flow: column nowrap; justify-content: center; align-items: center;">
  <h1>To-Don't List</h1>
  <fieldset
    style="display: flex; flex-flow: column nowrap; justify-content: center; align-items: center; width: 400px; border-radius: 25px;"
  >
    <%if(locals.data){%>
   
      <% data.forEach((item)=>{%>
        <form action="/update" method="post" id="update">

      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 8fr; min-width: 400px;" id="div<%=item.id%>">
       
      <input type="checkbox" name="checkbox" id="<%=item.id%>" style="width: 15px; height: 15px; margin: auto;" onclick="removeItem(this)">
   
      <img src="/img/edit.png" class="<%=item.id%>" alt="" width="15" height="15" style="margin:auto; padding-bottom: .19rem;" cursor: pointer;" onclick="edit(this)">
      
      
      <div></div>
      <p><%=item.todoitem%></p>
      
      </div>
      <div style="display: none; flex-flow: row nowrap; gap:1rem; height: 40px; align-items: center;" id="edit<%=item.id%>">
        <input type="text" style="padding: 0.2rem .4rem 0.2rem .4rem; margin-left: -.2rem; display: inherit;" name="<%=item.id%>" value="<%=item.todoitem%>" required>
        <button type="submit" id="save" style="background-color: rgb(113, 186, 255); color: black;border:none;border-radius:10px;padding: .6rem;">Save</button>
      </div>
    </form>
      <% }) %>
      
  

    <form action="/new" method="post" style="display: flex; flex-flow: row nowrap; gap:1rem; height: 40px; align-items: center; margin-top:1rem;">
      <img src="/img/add-button.png" style="font-size: 1em;cursor: pointer;" id="add" alt="" width="20" height="20" onclick="newItem(this)"/>

      <div id="newEntry" style="display: none;">
      <input type="text" name="newEntry" id="newEntry" style="padding: 0.2rem .4rem 0.2rem .4rem; margin-right:1rem; margin-left: -.2rem;" required />
      <button type="submit" id="send" style="margin-left:2rem;background-color: rgb(113, 186, 255); color: black; border:none;border-radius:10px;padding: .6rem;">Save</button>

    </div>
    </form>

    <%}else{%>
    <form action="/userSelect" method="post">
      <%users.forEach((item) => {%>
      <button type="submit" name="id" value="<%=item.id%>">
        <%=item.name %>
      </button>
      <% }) %>
    </form>
    <% }%>
  </fieldset>
</div>
<script>
  function edit(element) {
  const id = element.className;
  
  document.getElementById("div"+id).style.display= "none";
  document.getElementById("edit"+id).style.display= "flex";

  }

 function removeItem(checkbox){
  const id = checkbox.id;
  console.log(id);
   document.getElementById("div"+id).style.display= "none";
  document.getElementById("update").submit();
  
  
 }
 function newItem(element){
  element.style.display="none"
  document.getElementById("newEntry").style.display ="flex"
 }


</script>

<%- include("partials/footer.ejs") %>

